const TOKEN=getCookie("access_token"),api=axios.create({baseURL:"https://dimoldura-api.herokuapp.com/api/admin/",headers:{Authorization:"Bearer "+TOKEN,"Content.Type":"application/json"}}),EntityManager=function(){"use strict";let e="",a="",t="",n="";const i={entity:"",path:"/"};let r=function(t,i){let r={path:a};api.get(""+e,{params:r}).then(e=>{n=e.data,p(),null!=t&&t(e)}).catch(e=>{i(e)})},o=function(e){console.log(e),jQuery(this).removeWaiting(),showError("Dimoldura",e)},p=function(){jQuery("#mediaselector").html(""),console.log("render");var e=jQuery("<li data-path='"+n.previous+"' data-type='dir' class='back'>");e.append("<a><span class='name'>Anterior</span></a>"),jQuery("#mediaselector").append(e),n.directories.forEach((function(e,a){var t=e.lastIndexOf("/"),n=e.substring(t),i=jQuery("<li data-path='"+e+"' data-type='dir' class='folder'>");i.append("<input type='checkbox' class='selector'/>").append("<a><span class='name'>"+n+"</span></a>"),jQuery("#mediaselector").append(i)})),n.files.forEach((function(e,a){var t=e.lastIndexOf("/"),n=e.substring(t),i=jQuery("<li data-path='"+e+"' data-type='file' class='file'>");i.append("<input type='checkbox' class='selector'/>").append("<img src='https://onoffmultimedia.com/dimoldura-media/"+e+"'></img>").append("<span class='name'>"+n+"</span>"),jQuery("#mediaselector").append(i)}))},c=function(){jQuery("#mediaselector").on("click","a",(function(e){a=jQuery(this).parent().data("path"),r(null,o),jQuery(this).addClass("waiting")})),jQuery("#create-folder").on("click",(function(t){t.preventDefault(),t.stopPropagation(),function(t,n){let i=jQuery("#folder").val(),o={path:a+"/"+i};api.post(e+"/folder",o).then(e=>{r(),null!=t&&t(e)}).catch(e=>{n(e)})}(null,o)})),jQuery("#new-file").on("click",(function(e){e.preventDefault(),e.stopPropagation(),jQuery("#image").trigger("click")})),jQuery("#image").on("change",(function(t){document.querySelector("#image");!function(t,n){var i=new FormData,o=document.querySelector("#image");i.append("image",o.files[0]),i.append("path",a),api.post(e+"/file",i,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{r()})}()}))};return{init:function(n){jQuery.extend(i,n),e=i.entity,a=i.path,t=null,r(null,o),c()}}}();